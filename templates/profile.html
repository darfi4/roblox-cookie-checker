{% extends "base.html" %}
{% block title %}–ü—Ä–æ—Ñ–∏–ª—å - RCC Pro{% endblock %}

{% block content %}
<section class="hero">
    <h1 class="hero-title">–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</h1>
    <p class="hero-subtitle">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∞—à–∏–º –∞–∫–∫–∞—É–Ω—Ç–æ–º –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</p>
</section>

<div class="card-grid">
    <div class="card">
        <h2 class="card-title"><i class="fas fa-user-circle"></i> –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–∫–∫–∞—É–Ω—Ç–µ</h2>
        <div style="display: grid; gap: 1.5rem;">
            <div style="display: flex; align-items: center; gap: 1rem; padding: 1rem; background: var(--glass-dark); border-radius: 10px;">
                <div style="font-size: 2rem; color: var(--primary);">
                    <i class="fas fa-user"></i>
                </div>
                <div>
                    <strong style="font-size: 1.2rem;">{{ current_user.email }}</strong>
                    <div style="opacity: 0.8; font-size: 0.9rem;">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω: {{ current_user.created_at.strftime('%d.%m.%Y') }}</div>
                </div>
            </div>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                <div style="text-align: center; padding: 1rem; background: var(--glass-dark); border-radius: 10px;">
                    <div style="font-size: 2rem; color: var(--primary); font-weight: bold;">
                        {{ total_scans }}
                    </div>
                    <div style="opacity: 0.8;">–í—Å–µ–≥–æ –ø—Ä–æ–≤–µ—Ä–æ–∫</div>
                </div>
                
                <div style="text-align: center; padding: 1rem; background: var(--glass-dark); border-radius: 10px;">
                    <div style="font-size: 2rem; color: var(--secondary); font-weight: bold;">
                        {{ total_cookies }}
                    </div>
                    <div style="opacity: 0.8;">–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –∫—É–∫–∏</div>
                </div>

                <div style="text-align: center; padding: 1rem; background: var(--glass-dark); border-radius: 10px;">
                    <div style="font-size: 2rem; color: var(--info); font-weight: bold;">
                        {% if total_cookies > 0 %}
                            {{ ((valid_cookies / total_cookies * 100) | round(1)) }}%
                        {% else %}
                            0%
                        {% endif %}
                    </div>
                    <div style="opacity: 0.8;">–í–∞–ª–∏–¥–Ω—ã—Ö</div>
                </div>
            </div>

            <div>
                <h3 style="margin-bottom: 1rem; color: var(--primary);">
                    <i class="fas fa-chart-bar"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
                </h3>
                <div style="display: grid; gap: 0.5rem;">
                    <div style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--glass-border);">
                        <span>–£—Ä–æ–≤–µ–Ω—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏:</span>
                        <span style="color: var(--secondary); font-weight: bold;">
                            {% if total_scans > 10 %}
                                –í—ã—Å–æ–∫–∏–π
                            {% elif total_scans > 3 %}
                                –°—Ä–µ–¥–Ω–∏–π
                            {% else %}
                                –ù–∏–∑–∫–∏–π
                            {% endif %}
                        </span>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--glass-border);">
                        <span>–ü–æ—Å–ª–µ–¥–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞:</span>
                        <span style="opacity: 0.8;">
                            {% if last_scan %}
                                {{ last_scan.created_at.strftime('%d.%m.%Y %H:%M') }}
                            {% else %}
                                –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö
                            {% endif %}
                        </span>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--glass-border);">
                        <span>–í–∞–ª–∏–¥–Ω—ã—Ö –∫—É–∫–∏:</span>
                        <span style="color: var(--secondary); font-weight: bold;">
                            {{ valid_cookies }}
                        </span>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 0.5rem 0;">
                        <span>–ù–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –∫—É–∫–∏:</span>
                        <span style="color: var(--danger); font-weight: bold;">
                            {{ total_cookies - valid_cookies }}
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="card">
        <h2 class="card-title"><i class="fas fa-cog"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–æ–º</h2>
        <div style="display: grid; gap: 1rem;">
            <a href="{{ url_for('auth.reset_password') }}" class="btn">
                <i class="fas fa-key"></i> –°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å
            </a>
            
            <a href="{{ url_for('history') }}" class="btn">
                <i class="fas fa-history"></i> –ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ–≤–µ—Ä–æ–∫
            </a>
            
            <a href="{{ url_for('dashboard') }}" class="btn">
                <i class="fas fa-tachometer-alt"></i> –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
            </a>

            <a href="{{ url_for('index') }}" class="btn btn-success">
                <i class="fas fa-search"></i> –ù–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
            </a>

            <div style="margin-top: 1rem; padding: 1rem; background: var(--glass-dark); border-radius: 10px;">
                <h3 style="margin-bottom: 0.5rem; color: var(--info);">
                    <i class="fas fa-download"></i> –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
                </h3>
                <p style="opacity: 0.8; font-size: 0.9rem; margin-bottom: 1rem;">
                    –í—ã –º–æ–∂–µ—Ç–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON
                </p>
                <button class="btn" style="width: 100%;" onclick="exportData()">
                    <i class="fas fa-file-export"></i> –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
                </button>
            </div>
        </div>

        <div style="margin-top: 2rem; padding: 1.5rem; background: var(--glass-dark); border-radius: 15px; border-left: 4px solid var(--secondary);">
            <h3 style="margin-bottom: 1rem; color: var(--secondary);">
                <i class="fas fa-shield-alt"></i> –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç–∞
            </h3>
            <ul style="list-style: none; padding: 0; display: grid; gap: 0.5rem;">
                <li style="display: flex; align-items: center; gap: 0.5rem;">
                    <i class="fas fa-check" style="color: var(--secondary);"></i>
                    <span>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–æ–∂–Ω—ã–µ –ø–∞—Ä–æ–ª–∏</span>
                </li>
                <li style="display: flex; align-items: center; gap: 0.5rem;">
                    <i class="fas fa-check" style="color: var(--secondary);"></i>
                    <span>–ù–µ —Å–æ–æ–±—â–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å —Ç—Ä–µ—Ç—å–∏–º –ª–∏—Ü–∞–º</span>
                </li>
                <li style="display: flex; align-items: center; gap: 0.5rem;">
                    <i class="fas fa-check" style="color: var(--secondary);"></i>
                    <span>–í—ã—Ö–æ–¥–∏—Ç–µ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞ –Ω–∞ —á—É–∂–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö</span>
                </li>
                <li style="display: flex; align-items: center; gap: 0.5rem;">
                    <i class="fas fa-check" style="color: var(--secondary);"></i>
                    <span>–†–µ–≥—É–ª—è—Ä–Ω–æ –º–µ–Ω—è–π—Ç–µ –ø–∞—Ä–æ–ª–∏</span>
                </li>
            </ul>
        </div>
    </div>
</div>

<div class="card" style="margin-top: 2rem;">
    <h2 class="card-title"><i class="fas fa-exclamation-triangle"></i> –û–ø–∞—Å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h2>
    <div style="display: grid; gap: 1rem;">
        <div style="padding: 1.5rem; background: rgba(239, 68, 68, 0.1); border: 1px solid var(--danger); border-radius: 10px;">
            <h3 style="color: var(--danger); margin-bottom: 1rem;">
                <i class="fas fa-trash-alt"></i> –£–¥–∞–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞
            </h3>
            <p style="opacity: 0.8; margin-bottom: 1rem;">
                –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ—Ç–º–µ–Ω–∏—Ç—å. –í—Å–µ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –±–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ —É–¥–∞–ª–µ–Ω—ã.
            </p>
            <button class="btn btn-danger" onclick="showDeleteConfirmation()">
                <i class="fas fa-trash"></i> –£–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç
            </button>
        </div>

        <div style="padding: 1.5rem; background: rgba(245, 158, 11, 0.1); border: 1px solid var(--warning); border-radius: 10px;">
            <h3 style="color: var(--warning); margin-bottom: 1rem;">
                <i class="fas fa-eraser"></i> –û—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏
            </h3>
            <p style="opacity: 0.8; margin-bottom: 1rem;">
                –£–¥–∞–ª–∏—Ç—å –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é –ø—Ä–æ–≤–µ—Ä–æ–∫. –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.
            </p>
            <button class="btn btn-warning" onclick="clearHistory()">
                <i class="fas fa-eraser"></i> –û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é
            </button>
        </div>
    </div>
</div>

<script>
function exportData() {
    showNotification('–§—É–Ω–∫—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –±–ª–∏–∂–∞–π—à–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏', 'info');
}

function showDeleteConfirmation() {
    if (confirm('üö® –í–ù–ò–ú–ê–ù–ò–ï! –í—ã —É–≤–µ—Ä–µ–Ω—ã —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç?\n\n–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ—Ç–º–µ–Ω–∏—Ç—å. –í—Å–µ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –±–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ —É–¥–∞–ª–µ–Ω—ã.')) {
        showNotification('–§—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É.', 'error');
    }
}

function clearHistory() {
    if (confirm('‚ö†Ô∏è –í—ã —É–≤–µ—Ä–µ–Ω—ã —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é –ø—Ä–æ–≤–µ—Ä–æ–∫?\n\n–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')) {
        showNotification('–§—É–Ω–∫—Ü–∏—è –æ—á–∏—Å—Ç–∫–∏ –∏—Å—Ç–æ—Ä–∏–∏ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏', 'warning');
    }
}

function showNotification(message, type = 'info') {
    // –£–¥–∞–ª—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
    const existingNotifications = document.querySelectorAll('.notification');
    existingNotifications.forEach(notification => notification.remove());
    
    const notification = document.createElement('div');
    notification.className = `notification ${type}`;
    notification.textContent = message;
    notification.style.cssText = `
        position: fixed;
        top: 100px;
        right: 20px;
        padding: 1rem 2rem;
        border-radius: 10px;
        color: white;
        font-weight: 600;
        z-index: 1000;
        animation: slideInRight 0.3s ease;
        backdrop-filter: blur(20px);
        max-width: 400px;
    `;
    
    if (type === 'success') notification.style.background = 'var(--secondary)';
    else if (type === 'error') notification.style.background = 'var(--danger)';
    else if (type === 'warning') notification.style.background = 'var(--warning)';
    else notification.style.background = 'var(--info)';
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.style.animation = 'slideInRight 0.3s ease reverse';
        setTimeout(() => notification.remove(), 300);
    }, 4000);
}

// –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤
document.addEventListener('DOMContentLoaded', function() {
    const cards = document.querySelectorAll('.card');
    cards.forEach((card, index) => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(30px)';
        card.style.transition = 'all 0.6s ease';
        
        setTimeout(() => {
            card.style.opacity = '1';
            card.style.transform = 'translateY(0)';
        }, index * 100 + 200);
    });
    
    // –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –∫–∞—Ä—Ç–æ—á–µ–∫
    const statCards = document.querySelectorAll('[style*="text-align: center"]');
    statCards.forEach((card, index) => {
        card.style.transform = 'scale(0.8)';
        card.style.transition = 'all 0.5s ease';
        
        setTimeout(() => {
            card.style.transform = 'scale(1)';
        }, index * 100 + 500);
    });
});

// –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π
const style = document.createElement('style');
style.textContent = `
    @keyframes slideInRight {
        from {
            transform: translateX(100%);
            opacity: 0;
        }
        to {
            transform: translateX(0);
            opacity: 1;
        }
    }
    
    .card {
        opacity: 0;
        transform: translateY(30px);
        transition: all 0.6s ease;
    }
    
    .btn {
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }
    
    .btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
        transition: left 0.5s;
    }
    
    .btn:hover::before {
        left: 100%;
    }
    
    .btn:hover {
        transform: translateY(-2px);
    }
    
    .stat-card {
        transition: all 0.3s ease;
    }
    
    .stat-card:hover {
        transform: translateY(-5px) scale(1.05);
    }
`;
document.head.appendChild(style);
</script>

<style>
.hero-title {
    background: linear-gradient(45deg, var(--primary), var(--secondary), var(--info));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    background-size: 200% 200%;
    animation: gradientShift 3s ease infinite;
}

@keyframes gradientShift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

.card {
    backdrop-filter: blur(20px);
    border: 1px solid var(--glass-border);
    transition: all 0.4s ease;
}

.card:hover {
    transform: translateY(-5px);
    box-shadow: 0 20px 40px rgba(0,0,0,0.3);
}

.btn {
    backdrop-filter: blur(10px);
}
</style>
{% endblock %}